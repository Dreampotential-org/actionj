var segments = [
    {
        id: 99,
        type: 'image_text_choices_answers',
        img: 'img/wholehouse_13543large_2.jpeg',
        title: 'What accounts for the most energy use in American homes?',
        choices: ['Heating and cooling',
            'Water heating',
            'Electronics and lighting',
            'Appliances'],
        answer: 'Heating and cooling',
        answer_text: 'According to the most recent Residential Energy Consumption Survey, heating and cooling accounted for 48 percent of total energy consumption in American homes. However, this number is down from 58 percent in 1993 as a result of improved technology and products such as more energy efficient heating and cooling systems, better insulation and energy efficient windows.'
    },
    {
        id: 98,
        type: 'image_text_choices_answers',
        img: 'img/577ba48fb4a5b.jpeg',
        title: 'How much electricity does a typical American home use per month?',
        choices: ['About 9000 kilowatt hours',
            'About 900 kilowatt hours',
            '1.21 gigawatt hours',
            'About 90,000 kilowatt hours'],
        answer: 'About 900 kilowatt hours',
        answer_text: 'According to the Energy Information Administration, average annual electricity consumption for a U.S. residential utility customer was 10,908 kilowatt hours, an average of 909 kilowatt hours per month.'
    },
    {
        id: 97,
        type: 'image_text_choices_answers',
        img: 'img/resized_electricity_pylon_cropped.jpg',
        title: 'How much does a typical U.S. family spend on home utility bills per year?',
        choices: ['$1,100',
            '$2,200',
            '$5,500',
            '$3,300'],
        answer: '$2,200',
        answer_text: 'The 115 million residences in America today collectively use an estimated 22.5 percent of the country`s total energy. The typical U.S. family spends at least $2,200 a year on home utility bills. Switching to ENERGY STAR products and making home energy upgrades can help lower these costs.'
    },
    {
        id: 96,
        type: 'image_text_choices_answers',
        img: 'img/advanced_power_strips_26761.jpg',
        title: 'Which state consumes the most amount of electricity per household?',
        choices: ['Florida',
            'California',
            'New York',
            'Louisiana'],
        answer: 'Louisiana',
        answer_text: 'In 2013, Louisiana had the highest average annual electricity consumption per residential utility customer at 15,270 kilowatt hours. Hawaii had the lowest average annual electricity consumption per residential utility customer at 6,176 kilowatt hours.'
    },
    {
        id: 95,
        type: 'image_text_choices_answers',
        img: 'img/Plug_745x350.jpg',
        title: 'What are phantom loads?',
        choices: ['Electronics and appliances that consume power when they are turned off but still plugged in.',
            'Residual or unused energy that can be re-purposed to power electronics and appliances.',
            'The energy stored in electronics and appliances after they are unplugged.',
            'Warnings on electronic devices that indicate they need to be charged or plugged in.'],
        answer: 'Electronics and appliances that consume power when they are turned off but still plugged in.',
        answer_text: 'A phantom load, also called standby power, refers to power consumed by electronics and appliances while they are switched off. According to Lawrence Berkeley National Laboratory, a typical American home has forty products constantly drawing power. Together these amount to almost 10 percent of residential electricity use.'
    },
    {
        id: 94,
        type: 'image_text_choices_answers',
        img: 'img/guide_energyefficiency_istock-530285863_2400px.jpg',
        title: 'How much money can you save by switching to ENERGY STAR appliances, fans and electronics over their lifetime?',
        choices: ['$750',
            '$921',
            '$575',
            '$1,000'],
        answer: '$750',
        answer_text: 'Using ENERGY STAR certified products -- which incorporate advanced technologies that use 10 to 15 percent less energy and water than standard models -- throughout your home could save nearly $750 over the lifetime of the products. For example, ENERGY STAR clothes washers use about 40 percent less energy than conventional clothes washers while reducing water bills.'
    },
    {
        id: 93,
        type: 'image_text_choices_answers',
        img: 'img/thermostat_11894428.jpg',
        title: 'Using a programmable thermostat to set back your temperature 10Â°F for 8 hours a day can lower your heating and cooling costs by what percent per year?',
        choices: ['15 percent',
            '5 percent',
            '8 percent',
            '10 percent'],
        answer: '10 percent',
        answer_text: 'You could save roughly 10 percent a year on heating and cooling costs by using a programmable thermostat. Also, by resetting it when you are asleep or away from home, you won`t have to sacrifice comfort for savings.'
    },
    {
        id: 92,
        type: 'image_text_choices_answers',
        img: 'img/smart-meter-cropped_0.jpg',
        title: 'Which of these is NOT a way to save energy at home?',
        choices: ['Air drying clothes.',
            'Plugging electronics into power strips and turning them off when not in use.',
            'Turning lights and appliances off when not in the',
            'Closing HVAC vents in rooms that aren`t being used.'],
        answer: 'Closing HVAC vents in rooms that aren`t being used.',
        answer_text: 'You could save roughly 10 percent a year on heating and cooling costs by using a programmable thermostat. Also, by resetting it when you are asleep or away from home, you won`t have to sacrifice comfort for savings.'
    },
    {
        id: 91,
        type: 'image_text_choices_answers',
        img: 'img/heat-pump-76690067-1.jpg',
        title: 'What kind of heat pump uses the constant temperature located just below the ground to heat or cool homes?',
        choices: ['Air',
            'Geothermal',
            'Water',
            'Subterranean'],
        answer: 'Geothermal',
        answer_text: 'Geothermal heat pumps use the constant temperature of the earth as the exchange medium instead of the outside air temperature. These type of heat pumps can reduce energy use by 30 to 60 percent , control humidity, are sturdy and reliable, and fit in a wide variety of homes.'
    },
    {
        id: 90,
        type: 'image_text_choices_answers',
        img: 'img/toz_JohnHubert12_zipwallroof-2014.jpg',
        title: 'What`s a cool roof?',
        choices: ['A roof of a building that is partially or completely covered with grass or vegetation.',
            'A roof with solar panels that provide power to select parts of the house.',
            'A roof that uses material designed to reflect more sunlight and absorb less heat than a standard roof.',
            'A roof that contains air conditioning and home cooling equipment.'],
        answer: 'A roof that uses material designed to reflect more sunlight and absorb less heat than a standard roof.',
        answer_text: 'Cool roofs can be made of a highly reflective type of paint, a sheet covering, or highly reflective tiles or shingles. By installing a cool roof, you can lower the temperature of your roof by up to 50 degress fahrenheit and save energy and money by using less air conditioning.'
    },
    {
        id: 89,
        type: 'image_text_choices_answers',
        img: 'img/2010_blown_insulation_-_energy_masters_commercial_-_www.energymasterscommercial.com_.jpeg',
        title: 'Which of the following is NOT a type of insulation?',
        choices: ['Rolls and batts',
            'Rigid foam',
            'Loose-fill',
            'Synthetic fiber'],
        answer: 'Synthetic fiber',
        answer_text: 'Insulation is made from a variety of materials, usually comes in four types: rolls and batts, loose-fill, rigid foam, and foam-in-place. One of the most cost-effective ways to make your home more comfortable year-round is to add insulation to your attic, including the attic trap or access door.'
    },

    {
        id: 88,
        type: 'image_text_choices_answers',
        img: 'img/Water Heater.jpg',
        title: 'Which type of water heater provides hot water only as it is needed?',
        choices: ['Conventional',
            'Solar',
            'Heat pump',
            'Tankless'],
        answer: 'Tankless',
        answer_text: 'Tankless water heaters, also known as demand-type or instantaneous water heaters, provide hot water only as it is needed. They don`t produce the standby energy losses associated with storage water heaters, which can save you money. For homes that use 41 gallons or less of hot water daily, demand water heaters can be 24 to 34 percent more energy efficient than conventional storage tank water heaters.'
    },
    {
        id: 87,
        type: 'image_text_choices_answers',
        img: 'img/10898_0.jpeg',
        title: 'Which of the following is NOT true about LED lighting?',
        choices: ['LEDs are compound semiconductor devices that produce light when an appropriate electrical current is applied.',
            'LEDs emit light in a specific direction, reducing the need for reflectors and diffusers that can trap light.',
            'Because of their long life, durability, and efficiency, LEDs are becoming more common in residential, commercial, and outdoor area lighting applications.',
            'LED stands for light-energy diode.'],
        answer: 'LED stands for light-energy diode.',
        answer_text: 'The light-emitting diode (LED) is one of today`s most energy-efficient and rapidly-developing lighting technologies. ENERGY STAR-qualified LEDs use only about 20 to 25 percent of the energy and last up to 25 times longer than traditional incandescent bulbs.'
    },
    {

        id: 7,
        title: 'Learn about the Clamagore in 3D',
        type: 'html',
        html: '<iframe frameborder="0" ' +
                'src="https://my.matterport.com/show/?m=GAPCjiGGCZ5?autoplay=1" ' +
                'sandbox="allow-same-origin allow-scripts allow-popups allow-forms" ' +
                '></iframe>',
    },
    {
        id: 1,
        type: 'title_text',
        title: 'The USS Clamagore: A Diesel Powered Submarine',
        textarea_div: `
The USS Clamagore used diesel fuel oil to make her go! This isn't anything you would find in the kitchen- no- not that kind of oil.

Let's break down what diesel fuel oil is:

It is a liquid and has the basic properties of liquid matter, including taking the shape of its container.
It is a homogeneous mixture, meaning it is made up of the same amounts of different liquids.
These liquids come from crude oil. Crude oil is also referred to as a fossil fuel because over long periods of geologic time it formed from decayed plants and animals.
`
    },
    {
        id: 7,
        title: 'How does Diesel Fuel Process',
        type: 'html',
        html: "<img src='img/oil.jpg'></img>",
    },
    {
        id: 7,
        title: 'Matter Video',
        type: 'html',
        html: "<video src='video.mp4' controls></video>",
    },
    {
        id: 4,
        type: 'question_choices',
        title: 'What type of Matter is Diesel?',
        choices: ['Soild', 'Liquid', 'Gas'],
        textarea_div: 'display this text on page in div'
    },
    {
        id: 2,
        type: 'title_text',
        title: 'Here is a title in bold on page',
        textarea_div: 'display this text on page in div'
    },
            /*
             {
             id: 3,
             type: 'question_choices',
             title: 'Here is a title in bold on page',
             choices: ['choice string 1 via radio button', 'two string'],
             textarea_div: 'display this text on page in div'
             },
             {
             id: 4,
             type: 'question_choices',
             title: 'Here is another set of questions',
             choices: ['choice 1', 'choice 2', 'choice 3'],
             textarea_div: 'display this text on page in div'
             } */
]

var currentTab = 0

function init() {

    var html = ''
    var que = ''

    segments.forEach((element, i) => {
        que += `<div class="tab" question_id=${element.id} id="tab${i}">
                      ${getOptions(i)}
                    </div>`
        html += `<span class="step"></span>`
    })

    que += `<div style="overflow:auto;">
                <div style="float:right;">
                    <button type="button" class="btn btn-default" id="prevBtn"
                        onclick="nextPrev(-1)">Previous</button>
                    <button type="button" class="btn btn-success" id="nextBtn"
                        onclick="nextPrev(1)">Next</button>
    <a href="index.html" class="btn btn-primary" id="Suggestions">Suggestions</a>
                </div>
            </div>`

    que += `<div id="custom-indicator"
            style="text-align:center;margin-top:40px;">${html}</div>`

    $('#segForm').append(que)
    showTab(currentTab)
}

function display_question(segment) {
    var html = ''
    var que = ''
    // console.log(questions)
    que += `<div class="tab" segment_id=${segment.id} id="tab${currentTab}">
                    <h4>${segment.title}</h4>
                    ${getOptions(segment.choices, currentTab)}
                </div>`
    html += `<span class="step"></span>`

    que += `<div style="overflow:auto;">
                <div style="float:right;">
                    <button type="button" id="prevBtn"
                        onclick="nextPrev(-1)">Previous</button>
                    <button type="button" id="nextBtn"
                        onclick="nextPrev(1)" disabled>Next</button>
    <button type="button" id="Suggestions">Suggestions</button>
                </div>
            </div>`

    que += `<div id="custom-indicator"
            style="text-align:center;margin-top:40px;">${html}</div>`

    $('#segForm').append(que)
    showTab(currentTab)
}

var answers = []
function getOptions(i) {

    var view = ''
    if (segments[i].type == 'html') {
        view = `<div class="form-group">
        <div><b>${segments[i].title}<b></div>
        ${segments[i].html}
    </div>`

    } else if (segments[i].type == 'speed_read') {
        view = `<div class="form-group">
                <textarea class="form-control" id="speed_read_input" rows="7" placeholder="">${
                segments[i].textarea_div
                }</textarea>
            </div>`
    } else if (segments[i].type == 'title_text') {
        view = `<div class="form-group">
                <input type="text" class="form-control" id="playtitle"  placeholder="Title" value="${
                segments[i].title
                }" readonly>
            </div>
            <div class="form-group">
                <textarea class="form-control" id="playspeed_read_input" rows="7" placeholder="" value="">${
                segments[i].textarea_div
                }</textarea>
            </div>`
    } else if (segments[i].type == 'image_text_choices_answers') {
        view = `<div class="form-group">
                <div class="question">${segments[i].title}</div>
                <div class="img"><img src="${segments[i].img}"></div>
            </div>`
        segments[i].choices.forEach(item => {
            view += `<div class="radio">
                        <label><input type="radio" id="${segments[i].id}" value="${item}"
                                oninput="this.className = ''" name="que${i}">
                                    ${item}</label>
                    </div>`
        })

        view += `<div class="${segments[i].id}" id="explaination" style="display:none">${segments[i].answer_text}</div><br>`
    } else {
        view = `<h4>${segments[i].title}</h4>`
        segments[i].choices.forEach(item => {
            view += `<div class="radio">
                        <label><input type="radio" value="${item}"
                                oninput="this.className = ''" name="que${i}">
                                    ${item}</label>
                    </div>`
        })
    }

    return view
}

// var currentTab = 0; // Current tab is set to be the first tab (0)
// showTab(currentTab); // Display the current tab

var isDisable = true

function showTab(n) {
    // This function will display the specified tab of the form...

    $('input[type=radio]').change(function () {
        isDisable = false
        // $('#nextBtn').removeAttr('disabled')
    })

    $('#prevBtn').click(function () {
        isDisable = false
        // $('#nextBtn').removeAttr('disabled')
    })

    // if (isDisable) $('#nextBtn').attr('disabled', true)

    if (n >= segments.length) {
        // send results to backend
        return
    }
    var x = document.getElementsByClassName('tab')
    x[n].style.display = 'block'
    // ... and fix the Previous/Next buttons:
    if (n == 0) {
        document.getElementById('prevBtn').style.display = 'none'
    } else {
        document.getElementById('prevBtn').style.display = 'inline'
    }
    if (n == x.length - 1) {
        // document.getElementById('nextBtn').innerHTML = 'Submit'
        document.getElementById('nextBtn').style.display = 'none'

        swal({
            title: "Done",
            text: "Lesson Completed",
            icon: 'success',
        })


    } else {
        document.getElementById('nextBtn').style.display = 'inline'
        document.getElementById('Suggestions').style.display = 'inline'
        document.getElementById('nextBtn').innerHTML = 'Next'
    }


    // ... and run a function that will display the correct step indicator:
    fixStepIndicator(n)
}

function nextPrev(n) {
    // populate  question_answers
    // question_answers[$('#tab' + currentTab).attr('question_id')] = $(
    //   '#tab' + currentTab + ' .radio input:checked'
    // ).val()

    // This function will figure out which tab to display
    var x = document.getElementsByClassName('tab')
    // Exit the function if any field in the current tab is invalid:
    // if (n == 1 && !validateForm()) return false
    // Hide the current tab:
    x[currentTab].style.display = 'none'
    // Increase or decrease the current tab by 1:
    currentTab = currentTab + n
    // if you have reached the end of the form...
    if (currentTab >= x.length) {
        // ... the form gets submitted:
        // return false;
    }
    // Otherwise, display the correct tab:
    showTab(currentTab)
}

function fixStepIndicator(n) {
    // This function removes the "active" class of all steps...
    var i

    var x = document.getElementsByClassName('step')
    for (i = 0; i < x.length; i++) {
        x[i].className = x[i].className.replace(' active', '')
    }
    // ... and adds the "active" class on the current step:
    x[n].className += ' active'
}

window.addEventListener('DOMContentLoaded', init, false)

