<!DOCTYPE html>
<html lang="en">
<head>
    <title>Segment Builder</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>  
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>

    <style>
        .start-container{
            border: 1px solid lightgray;
            padding: 25px;
        }
    </style>
    
</head>

<body>
    <div class="container start-container">
        <div class="row">
            <div class="col-xs-6 col-sm-6">
                <h3>Segment Builder</h3>
                <select class="form-control" id="select_lesson" onchange="selectLesson()" >
                    
                </select>
                <a id="lesson_slide">View Lesson</a>
            </div>
            <div class="col-xs-6 col-sm-6" style="margin-top: 20px;margin-bottom: 10px;">
                <select class="form-control " id="selectsegment">
                    <option selected value="select_type">Select Segment Type</option>
                    <option value="speed_read">Speed Read</option>
                    <option value="title_text">Title Text</option>
                    <option value="question_choices">Question Choices</option>
                    <option value="iframe_link">Iframe Link</option>
                    <option value="video_file">Video File</option>
                    <option value="question_text">Question Text</option>
                </select>
                <button class="btn form-control btn-success" style="margin-top: 20px;margin-bottom: 10px; "id="add">Add</button>
                <input type="text" class="form-control" name="lesson_name" id="lesson_name" placeholder="Lesson Name">
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12" id="sortable">
                
            </div>
            <div class="col-xs-12">
                <form id="lesson_form">
                    <div class="speed_read" id="speed_read" style="display: none; padding-top: 15px">
                        <div class="ui-sortable-handle" style="margin-top:50px; padding:20px; border-radius:10px; border:1px; border-color:#888; border-style:solid;">
                            <div class="row">
                                <h4 class="col-xs-10 col-lg-11">Speed Read</h4>
                                <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                            </div>
                            
                            <div class="form-group">
                                <textarea class="form-control" name="speed_read" id="speed_read_input" rows="7" placeholder=""></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="speed_read" id="question_text" style="display: none; padding-top: 15px">
                        <div style="margin-top:50px; padding:20px; border-radius:10px; border:1px; border-color:#888; border-style:solid;">
                            <div class="row">
                                <h4 class="col-xs-10 col-lg-11">Question Text</h4>
                                <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                            </div>
                            
                            <div class="form-group">
                                <textarea class="form-control" name="speed_read" id="speed_read_input" rows="7" placeholder=""></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="speed_read" id="title_text" style="display: none; padding-top: 15px">
                        <div style="margin-top:50px; padding:20px; border-radius:10px; border:1px; border-color:#888; border-style:solid;">
                            <div class="row">
                                <h4 class="col-xs-10 col-lg-11">Title Text</h4>
                                <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control" id="title"  placeholder="Title">
                            </div>
                            <div class="form-group">
                                <textarea class="form-control" id="text" rows="7" placeholder=""></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="speed_read" id="question_choices" style="display: none; padding-top: 15px">
                        <div style="margin-top:50px; padding:20px; border-radius:10px; border:1px; border-color:#888; border-style:solid;">
                            <div class="row">
                                <h4 class="col-xs-10 col-lg-11">Question Choices</h4>
                                <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control" id="question"  placeholder="Question">
                            </div>
                            <div class="form-group" id="choices">
                                <div>
                                    <input type="text" class="form-control" rows="7" placeholder="Choices"><button onclick="$(this).parent().remove()">Remove Choice</button>
                                </div>
                            </div>
                            <button>Add Choice</button>
                            <div class="form-group">
                                <hr>
                                <input type="button" id="upload-img-btn" onclick="handleImageUpload()" value="Upload Image"/>
                                <input type="text" class="form-control" id="image" placeholder="Image Link" />
                                <div id="output"></div>
                            </div>
                            
                        </div>
                        <div class="speed_read" id="video_file" style="display: none; padding-top: 15px">
                            <div style="margin-top:50px">
                                <div class="row">
                                    <h4 class="col-xs-10 col-lg-11">Video File</h4>
                                    <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control" id="video_title"  placeholder="Title">
                                </div>

                                <div class="form-group">
                                    <input type="button" id="upload-vid-btn" onclick="handleVideoUpload()" value="Upload Video"/>
                                    <input type="text" class="form-control" id="video" placeholder="Video Link" />
                                </div>
                                <div id="video-output" style="display: none">
                                    <video  id="videoplayer" controls preload="none" width="480" height="360">
                                    </video>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="speed_read" id="iframe_link" style="display: none; ping-top: 15px">
                        <div style="margin-top:50px; padding:20px; border-radius:10px; border:1px; border-color:#888; border-style:solid;">
                            <div class="row">
                                <h4 class="col-xs-10 col-lg-11">Iframe Link</h4>
                                <a class="remove_flashcard col-xs-2 col-lg-1" style="color:red;font-weight:bold;font-size:23px;text-align:right;"> X </a>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control" id="title_iframe"  placeholder="Title">
                            </div>
                            
                            <div class="form-group">
                                <input type="text" class="form-control" id="iframe" placeholder="IFrame Link" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <input type="text" hidden name="signature" id="signInput">
                            <button class="btn btn-primary" type="button" onclick="signLesson(event,'lesson_signature', 'signInput')"> Click To Sign</button>
                            <img id="lesson_signature" hidden src="">
                        </div>
                    </div>
                    <button type="submit" class="form-control btn btn-primary" style="margin-top: 50px;">Save</button>
                </form>
            </div>
        </div>

        <form id="imageUploadForm" enctype="multipart/form-data" name="imageUploadForm" >
            <input type="file" name="imageUpload"  id="imageUpload" style='display:none;' onchange="handleImageSelect(this)" required/>
        </form>

        <form id="videoUploadForm" enctype="multipart/form-data" name="videoUploadForm" >
            <input type="file" name="videoUpload"  id="videoUpload" style='display:none;' onchange="handleVideoSelect(this)" required/>
        </form>

        
    <script src="js/lesson.js"></script> 
    <div id="sign-modal"></div>

    <script>        
        $('#sign-modal').load("signature/index.html");
        function signLesson(event, imgId, signInput){
            if($('#signature')){
                $('#signature').modal('show');
            }
            document.addEventListener('signatureSubmitted', function(e){
                $('#'+signInput).val(window.currentSignature.data);
                $('#'+imgId).attr('src',window.currentSignature.data); 
                $('#'+imgId).removeAttr('hidden'); 
                event.target.setAttribute('hidden',true);
                window.currentSignature = undefined;
            });            
        }
    </script>
   <script>
    $(document).ready(function () {
        $( "#sortable" ).sortable({
            stop: sortEventHandler
        });

        function sortEventHandler(){
            var i = 0 ;
            var childrenList  = $("#sortable").children();
            childrenList.each(function(e) { 
                $(this).attr("data-position",i)
                i++;
            })
        }

    });
</script>
</body>
</html>
