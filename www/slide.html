<!DOCTYPE html>
<html lang="en">
<head>
  <title>My Flashcards</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>
<body>

<div class="container">
  <br>
  <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false" >
    <!-- Indicators -->
    <ol class="carousel-indicators" id="carousel-indicators">
    </ol>

    <!-- Wrapper for slides -->
    <div class="carousel-inner" id="theSlide" style="height:600px;border:2px;border-style:solid;padding:10px;" role="listbox">
  
    </div>
    <button onclick="$('#myCarousel').carousel('next')">Next</button>
    <button onclick="$('#myCarousel').carousel('prev')">Previous</button>

  </div>
</div>
</html>
<style>
  .carousel-indicators li {
    display: inline-block;
    width: 20px;
    height: 20px;
    margin: 10px;
    text-indent: 0;
    cursor: pointer;
    border: none;
    border-radius: 50%;
    background-color: #0000ff;
    box-shadow: inset 1px 1px 1px 1px rgba(0,0,0,0.5);    
}
.carousel-indicators .active {
    width: 20px;
    height: 20px;
    margin: 10px;
    background-color: #ffff99;
}
</style>

<script>
  //var SERVER = "http://localhost:8000/";
  var SERVER ='https://sfapp-api.dreamstate-4-all.org'

  $(document).ready(function () {
        
    function getParam(sParam){
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++){
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam) {
            return sParameterName[1];
        }
    }
    }
    var lesson_id=  getParam("lesson_id");
                $.get(SERVER+'courses_api/lesson/read/'+lesson_id,function(response) {
                    var flashcards = response.flashcards;
                    console.log(flashcards)
                    var i = 0;
                    var className="item";
                    flashcards.forEach((flashcard) => {
                      if(i == 0){
                        className = "item active"
                      }else{
                        className = "item"
                      }
                        console.log(flashcard)
                        $("#carousel-indicators").append('<li data-target="#myCarousel" data-slide-to="'+i+'" class="active"></li>')
                        
                        if(flashcard.lesson_type == "quick_read"){
                          $("#theSlide").append('<div class="'+className+'"><div alt="quick_read" style="height:500px"><h1>'+flashcard.question+'</h1></div></div>')
                        }
                        if(flashcard.lesson_type == "title_text"){
                          $("#theSlide").append('<div class="'+className+'"><div alt="title_text" style="height:500px"><h1> '+flashcard.question+'</h1><h3>'+flashcard.answer+'</h3></div></div>')

                        }
                        if(flashcard.lesson_type == "question_choices"){
                          $("#theSlide").append('<div class="'+className+'" id="flashcard_'+i+'"><h1>'+flashcard.question+'</h1><ul></ul></div>')
                          if(flashcard.image){
                            $("#flashcard_"+i).prepend('<center><img src="https://media.istockphoto.com/photos/contact-details-picture-id174081040" alt="Chania" style="height:300px;border:5px;border-style:solid;border-color:black"></center>')
                          }
                          flashcard.options.split(",").forEach(function (valu) { 
                            $("#theSlide").find('ul').append("<li>"+valu+"</li>")

                          })

                        }

                        if(flashcard.lesson_type == "iframe_link"){
                          $("#theSlide").append('<div class="'+className+'"><div alt="title_text" style="height:500px"><h1> '+flashcard.question+'</h1><iframe src= "'+flashcard.image+'"></iframe></div></div>')
                        }


                        if(flashcard.lesson_type == "video_file"){
                          $("#theSlide").append('<div class="'+className+'"><div alt="title_text" style="height:500px"><h1> '+flashcard.question+'</h1><video controls> <source src= "'+flashcard.image+'"></video></div></div>')
                        }
                        i++;
                    })

                });
});
</script>