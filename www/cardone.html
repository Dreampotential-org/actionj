<!DOCTYPE html>
<html lang="en">

<head>
    <title>SF App</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="css/style.css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>

    <style>
        body {
            height: 100vh;
        }

        .main-div {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            background: gray;
        }

        .form-div {
            background: #fff;
            width: 100%;
            border-radius: 8px;
            padding: 10px;
        }

        .btn-custom {
            background: rgb(0, 215, 119);
            border-radius: 3px;
            font-size: 16px;
        }

        .have-act {
            margin-top: 7px;
        }

        .have-act span {
            color: #234C8B;
        }
    </style>

</head>

<body>
    <header>
        <div class="mainContainer" style="position: relative">
            <nav class="toggleBar">
                <span class="bar bar1"></span>
                <span class="bar bar2"></span>
                <span class="bar bar3"></span>
            </nav>
        </div>
    </header>
    <div class="main-div container">

        <form class="form-div" method="post" action="">

            <div class="form-group text-center">
                <img src="img/university.png" />
            </div>

            <div class="form-group">
                <!-- <label class="control-label col-sm-2" for="email">Email:</label> -->
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="name" id="name" placeholder="Name">
                </div>
            </div>
            <div class="form-group">
                <!-- <label class="control-label col-sm-2" for="email">Email:</label> -->
                <div class="col-sm-10">
                    <input type="email" class="form-control" name="email" id="email" placeholder="Email">
                </div>
            </div>
            <div class="form-group">
                <!-- <label class="control-label col-sm-2" for="pwd">Password:</label> -->
                <div class="col-sm-10">
                    <input type="password" class="form-control" name="password" id="pwd" placeholder="Password">
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10 text-center">
                    <button type="submit" class="btn btn-success btn-custom">Submit</button>
                    <p class="have-act">Have an account?
                        <span>Log In</span>
                    </p>
                </div>
            </div>

        </form>

    </div>

    <script>
        $(document).ready(function () {
            $("form").on("submit", function (ev) {
                ev.preventDefault();

                $.ajax({
                    url: "https://prod-api.useiam.net/api/create-user/",
                    type: "post",
                    data: $(this).serialize(),
                    success: function (response) {
                        // Whatever you want to do after the form is successfully submitted
                        console.log(response);
                        var msg = response.message
                        if (msg) {
                            swal({
                                title: msg,
                                text: '',
                                icon: 'error'
                            })
                            return
                        }

                        swal({
                            title: 'Sign up successfully.',
                            text: "",
                            icon: 'success'
                        })

                    },
                    error: function () {
                        swal({
                            title: 'Error',
                            text: '',
                            icon: 'error'
                        })
                    }
                });
            });
        });



        function signup_api(params) {

            var form = new FormData()
            form.append('name', params.name)
            form.append('email', params.email)
            form.append('password', params.password)

            var settings = {
                async: true,
                crossDomain: true,
                url: 'https://prod-api.useiam.net/api/create-user/',
                method: 'POST',
                processData: false,
                contentType: false,
                mimeType: 'multipart/form-data',
                data: form
            }

            $.ajax(settings)
                .done(function (response) {
                    $('#signupModal #nextBtn').removeClass('running')
                    var msg = JSON.parse(response).message
                    if (msg && msg == 'User already exists') {
                        swal({
                            title: 'Email already exists',
                            text: '',
                            icon: 'error'
                        })
                        return
                    }
                    localStorage.setItem('session_id', JSON.parse(response).token)
                    // show toggle bar
                    $('.toggleBar').show()
                    console.log('user logged in')
                    // after successful login or signup show dashboard contents
                    showATab('dashboard')
                    // close modals
                    closeAllModals()
                    $('.moto').show()

                    swal({
                        title: 'Good job!',
                        text: "You're logged in",
                        icon: 'success'
                    })

                    get_profile_info(function (msg) {
                        // show_set_monitor();
                    })

                    // $("#proTip").addClass("is-visible");
                })
                .fail(function (err) {
                    console.log(err)
                    $('#signupModal #nextBtn').removeClass('running')
                    console.log(err)
                    swal({
                        title: 'Error',
                        text: 'Invalid email or password',
                        icon: 'error'
                    })
                })
        }





    </script>

</body>

</html>